# ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šæ‰±ã„

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€äºˆç´„ãƒ‡ãƒ¼ã‚¿ã¨ãƒ­ã‚°ã®ç®¡ç†ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‘ ç›®æ¬¡

- [ãƒ‡ãƒ¼ã‚¿ä¿å­˜](#ãƒ‡ãƒ¼ã‚¿ä¿å­˜)
- [è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—](#è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—)
- [ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ](#ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ )
- [ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—](#ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—)
- [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](#ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º)
- [æ³¨æ„äº‹é …](#æ³¨æ„äº‹é …)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
- [ã¾ã¨ã‚](#ã¾ã¨ã‚)

## ãƒ‡ãƒ¼ã‚¿ä¿å­˜

### äºˆç´„ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

äºˆç´„ãƒ‡ãƒ¼ã‚¿ã¯ **JSONå½¢å¼** ã§ `data/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

| ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|---------|------|
| `data/reservations.json` | äºˆç´„ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ¬ç•ªãƒ»é–‹ç™ºå…±é€šï¼‰ |

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```json
[
  {
    "id": "a1b2c3d4e5f6g7h8",
    "user_id": "123456789012345678",
    "username": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
    "date": "2025-11-15",
    "start_time": "14:00",
    "end_time": "15:00",
    "comment": "æŠ€è¡“é¢æ¥",
    "status": "pending",
    "created_at": "2025-11-09T10:00:00Z",
    "updated_at": "2025-11-09T10:00:00Z"
  }
]
```

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | èª¬æ˜ | çµµæ–‡å­— |
|-----------|------|--------|
| `pending` | äºˆç´„ä¸­ | ğŸ“… |
| `completed` | å®Œäº† | âœ… |
| `cancelled` | ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ¸ˆã¿ | ğŸš« |

### è‡ªå‹•ä¿å­˜ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

äºˆç´„ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ï¼š

- âœ… Botèµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¿
- âœ… äºˆç´„ä½œæˆæ™‚ï¼ˆå³åº§ã«ä¿å­˜ï¼‰
- âœ… äºˆç´„æ›´æ–°æ™‚ï¼ˆå³åº§ã«ä¿å­˜ï¼‰
- âœ… äºˆç´„å‰Šé™¤æ™‚ï¼ˆå³åº§ã«ä¿å­˜ï¼‰
- âœ… **5åˆ†ã”ã¨**ã«å®šæœŸä¿å­˜
- âœ… Botçµ‚äº†æ™‚ã«ä¿å­˜


## è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

äºˆç´„ãƒ‡ãƒ¼ã‚¿ãŒæ°¸ä¹…ã«è“„ç©ã—ãªã„ã‚ˆã†ã«ã€è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

### 1. æœŸé™åˆ‡ã‚Œäºˆç´„ã®è‡ªå‹•å®Œäº†

**å®Ÿè¡Œæ™‚åˆ»**: **æ¯æ—¥åˆå‰3æ™‚00åˆ†**

**å‹•ä½œ**:
- çµ‚äº†æ™‚åˆ»ãŒéããŸ `pending`ï¼ˆäºˆç´„ä¸­ï¼‰äºˆç´„ã‚’è‡ªå‹•çš„ã« `completed`ï¼ˆå®Œäº†ï¼‰ã«å¤‰æ›´

**ç›®çš„**:
- äºˆç´„çŠ¶æ…‹ã‚’æ­£ç¢ºã«ä¿ã¤
- æ‰‹å‹•å®Œäº†å¿˜ã‚Œã‚’é˜²ã

**ãƒ­ã‚°å‡ºåŠ›ä¾‹**:
```
[2025-11-10 03:00:00] Auto-completed 3 expired reservation(s)
[2025-11-10 03:00:00] Reservations saved successfully
```


### 2. å¤ã„äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•å‰Šé™¤

**å®Ÿè¡Œæ™‚åˆ»**: **æ¯æ—¥åˆå‰3æ™‚10åˆ†**

**å‹•ä½œ**:
- `completed` ã¾ãŸã¯ `cancelled` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®äºˆç´„ã§ã€æœ€çµ‚æ›´æ–°ã‹ã‚‰ **30æ—¥ä»¥ä¸Š** çµŒéã—ãŸã‚‚ã®ã‚’è‡ªå‹•å‰Šé™¤

**å¯¾è±¡**:
- âœ… `completed`ï¼ˆå®Œäº†ï¼‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®äºˆç´„
- âœ… `cancelled`ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«æ¸ˆã¿ï¼‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®äºˆç´„
- âŒ `pending`ï¼ˆäºˆç´„ä¸­ï¼‰ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“

**åˆ¤å®šåŸºæº–**:
```
ç¾åœ¨æ™‚åˆ» - 30æ—¥ > UpdatedAt ã®å ´åˆã«å‰Šé™¤
```

**ä¾‹**:
- ä»Šæ—¥: 2025å¹´11æœˆ9æ—¥
- å‰Šé™¤å¯¾è±¡: 2025å¹´10æœˆ9æ—¥ä»¥å‰ã«å®Œäº†/ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸäºˆç´„
- ä¿æŒ: 2025å¹´10æœˆ10æ—¥ä»¥é™ã®äºˆç´„

**ãƒ­ã‚°å‡ºåŠ›ä¾‹**:
```
[2025-11-10 03:10:00] Cleaned up 5 old reservation(s)
[2025-11-10 03:10:00] Reservations saved successfully
```


### 3. èµ·å‹•æ™‚ã®å‹•ä½œ

Botèµ·å‹•æ™‚ãŒæ·±å¤œ0æ™‚ã€œ0æ™‚5åˆ†ã®å ´åˆã€å³åº§ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**ãƒ­ã‚°å‡ºåŠ›ä¾‹**:
```
Bot is now running. Press CTRL+C to exit.
Next auto-complete scheduled at: 2025-11-10 03:00:00 (in 8h45m32s)
Next cleanup scheduled at: 2025-11-10 03:10:00 (in 8h55m32s)
```



## ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ 

### ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
logs/
â”œâ”€â”€ command_stats.json          # ã‚³ãƒãƒ³ãƒ‰çµ±è¨ˆï¼ˆJSONï¼‰
â”œâ”€â”€ commands_2025-11.log        # 2025å¹´11æœˆã®ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°
â”œâ”€â”€ commands_2025-12.log        # 2025å¹´12æœˆã®ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°
â”œâ”€â”€ errors_2025-11.log          # 2025å¹´11æœˆã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
â”œâ”€â”€ errors_2025-12.log          # 2025å¹´12æœˆã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
â””â”€â”€ ...
```

### 1. ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«åå½¢å¼**: `commands_YYYY-MM.log`

**å†…å®¹**: å„è¡ŒãŒJSONå½¢å¼ã®ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒª

```json
{
  "timestamp": "2025-11-09T14:30:00Z",
  "command": "reserve",
  "user_id": "123456789012345678",
  "username": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
  "channel_id": "987654321098765432",
  "success": true,
  "error": "",
  "parameters": {
    "date": "2025-11-15",
    "start_time": "14:00",
    "end_time": "15:00"
  }
}
```

### 2. ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ï¼ˆNEWï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«åå½¢å¼**: `errors_YYYY-MM.log`

**å†…å®¹**: ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã¨ã‚³ãƒãƒ³ãƒ‰ã‚¨ãƒ©ãƒ¼ã®è©³ç´°

```json
{
  "timestamp": "2025-11-09T14:35:00Z",
  "level": "ERROR",
  "source": "handlers.handleReserve",
  "message": "Failed to save reservations",
  "error": "write error: disk full",
  "details": {
    "user_id": "123456789012345678",
    "reservation_id": "a1b2c3d4e5f6g7h8"
  }
}
```

**è¨˜éŒ²ã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼:**
- äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜/èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚¨ãƒ©ãƒ¼
- è‡ªå‹•å®Œäº†/ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼
- ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼

### 3. çµ±è¨ˆãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ•ã‚¡ã‚¤ãƒ«å**: `command_stats.json`

**å†…å®¹**: ã‚³ãƒãƒ³ãƒ‰ã®çµ±è¨ˆæƒ…å ±

```json
{
  "total_commands": 150,
  "command_counts": {
    "reserve": 45,
    "cancel": 12,
    "complete": 38,
    "list": 30,
    "my-reservations": 20,
    "help": 3,
    "feedback": 2
  },
  "user_counts": {
    "123456789012345678": 25,
    "987654321098765432": 18
  },
  "last_updated": "2025-11-09T14:30:00Z",
  "monthly_stats": {
    "2025-11": {
      "year": 2025,
      "month": 11,
      "total_commands": 150,
      "command_counts": {...},
      "user_counts": {...}
    }
  }
}
```

### 4. ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ï¼ˆæ¨™æº–å‡ºåŠ›ï¼‰

ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã¯æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã•ã‚Œã¾ã™ï¼š

**å‡ºåŠ›ä¾‹:**
```
ğŸ’¾ Reservations saved successfully
âœ… Auto-completed 3 expired reservation(s) and saved
ğŸ—‘ï¸  Cleaned up 5 old reservation(s) and saved
âŒ Failed to save reservations: write error
```

**è¨˜éŒ²ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ:**
- å®šæœŸä¿å­˜ã®æˆåŠŸ/å¤±æ•—
- è‡ªå‹•å®Œäº†ã®å®Ÿè¡Œçµæœ
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®å®Ÿè¡Œçµæœ
- Botèµ·å‹•/çµ‚äº†


### ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

**è‡ªå‹•ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**:
- æœˆãŒå¤‰ã‚ã‚‹ã¨è‡ªå‹•çš„ã«æ–°ã—ã„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- å¤ã„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¿æŒã•ã‚Œã‚‹

**å¤ã„ãƒ­ã‚°ã®å‰Šé™¤**:
- **1ã‹æœˆä»¥ä¸Šå‰**ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•å‰Šé™¤ï¼ˆ`commands_*.log` ã¨ `errors_*.log`ï¼‰
- å®Ÿè¡Œé »åº¦: **24æ™‚é–“ã”ã¨**
- ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ç¯€ç´„

### ãƒ­ã‚°ã®ç¢ºèªæ–¹æ³•

```bash
# ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèª
cat logs/commands_2025-11.log

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
cat logs/errors_2025-11.log

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ã‚’ç›£è¦–
tail -f logs/commands_2025-11.log
tail -f logs/errors_2025-11.log

# ç‰¹å®šã®ã‚³ãƒãƒ³ãƒ‰ã®ãƒ­ã‚°ã‚’æ¤œç´¢
grep '"command":"reserve"' logs/commands_2025-11.log

# ã‚³ãƒãƒ³ãƒ‰ã‚¨ãƒ©ãƒ¼ã®ã¿ã‚’è¡¨ç¤º
grep '"success":false' logs/commands_2025-11.log

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‹ã‚‰ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ã‚’æ¤œç´¢
grep '"level":"ERROR"' logs/errors_2025-11.log

# çµ±è¨ˆæƒ…å ±ã‚’ç¢ºèª
cat logs/command_stats.json | jq .

# ç·ã‚³ãƒãƒ³ãƒ‰æ•°ã‚’ç¢ºèª
cat logs/command_stats.json | jq '.total_commands'

# ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿä»¶æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
wc -l logs/errors_2025-11.log
```


## ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### äºˆç´„ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
# æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
cp data/reservations.json data/reservations_backup_$(date +%Y%m%d).json

# å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆcronã§è¨­å®šï¼‰
# æ¯æ—¥åˆå‰2æ™‚ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
0 2 * * * cp /path/to/booking.hxs/data/reservations.json /path/to/backups/reservations_$(date +\%Y\%m\%d).json
```

### ãƒ­ã‚°ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
# ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf logs_backup_$(date +%Y%m%d).tar.gz logs/

# ç‰¹å®šã®æœˆã®ãƒ­ã‚°ã®ã¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
cp logs/commands_2025-11.log backups/
```

### ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒ

```bash
# äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
cp data/reservations_backup_20251109.json data/reservations.json

# Botã‚’å†èµ·å‹•ã—ã¦å¤‰æ›´ã‚’åæ˜ 
# ã¾ãŸã¯ systemdçµŒç”±ã§å†èµ·å‹•
systemctl restart booking-hxs
```


## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### å„ç¨®è¨­å®šå€¤ã®å¤‰æ›´

`cmd/bot/main.go` ã®å†’é ­ã«ã‚ã‚‹å®šæ•°ã‚’ç·¨é›†ã—ã¦ã€å„ç¨®è¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ï¼š

```go
const (
	saveInterval       = 5 * time.Minute  // å®šæœŸä¿å­˜é–“éš”
	logCleanupInterval = 24 * time.Hour   // ãƒ­ã‚°ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–“éš”
	autoCompleteHour   = 3                // è‡ªå‹•å®Œäº†å®Ÿè¡Œæ™‚åˆ»ï¼ˆæ™‚ï¼‰
	autoCompleteMinute = 0                // è‡ªå‹•å®Œäº†å®Ÿè¡Œæ™‚åˆ»ï¼ˆåˆ†ï¼‰
	cleanupHour        = 3                // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œæ™‚åˆ»ï¼ˆæ™‚ï¼‰
	cleanupMinute      = 10               // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œæ™‚åˆ»ï¼ˆåˆ†ï¼‰
	retentionDays      = 30               // ãƒ‡ãƒ¼ã‚¿ä¿æŒæœŸé–“ï¼ˆæ—¥ï¼‰
)
```

#### ä¿æŒæœŸé–“ã®å¤‰æ›´

```go
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30æ—¥
retentionDays = 30

// ä¾‹: 60æ—¥ã«å¤‰æ›´
retentionDays = 60

// ä¾‹: 7æ—¥ã«å¤‰æ›´ï¼ˆçŸ­æœŸé–“ï¼‰
retentionDays = 7
```

#### æœŸé™åˆ‡ã‚Œäºˆç´„ã®è‡ªå‹•å®Œäº†æ™‚åˆ»ã®å¤‰æ›´

```go
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: åˆå‰3æ™‚00åˆ†
autoCompleteHour   = 3
autoCompleteMinute = 0

// ä¾‹: åˆå‰2æ™‚00åˆ†ã«å¤‰æ›´
autoCompleteHour   = 2
autoCompleteMinute = 0

// ä¾‹: åˆå¾Œ11æ™‚30åˆ†ã«å¤‰æ›´
autoCompleteHour   = 23
autoCompleteMinute = 30
```

#### å¤ã„ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤æ™‚åˆ»ã®å¤‰æ›´

```go
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: åˆå‰3æ™‚10åˆ†
cleanupHour   = 3
cleanupMinute = 10

// ä¾‹: åˆå‰4æ™‚30åˆ†ã«å¤‰æ›´
cleanupHour   = 4
cleanupMinute = 30
```

#### å®šæœŸä¿å­˜é–“éš”ã®å¤‰æ›´

```go
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5åˆ†ã”ã¨
saveInterval = 5 * time.Minute

// ä¾‹: 10åˆ†ã”ã¨ã«å¤‰æ›´
saveInterval = 10 * time.Minute

// ä¾‹: 1åˆ†ã”ã¨ã«å¤‰æ›´ï¼ˆé »ç¹ã«ä¿å­˜ï¼‰
saveInterval = 1 * time.Minute
```

å¤‰æ›´å¾Œã€å†ãƒ“ãƒ«ãƒ‰ãŒå¿…è¦ã§ã™ï¼š
```bash
make build
```


### ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’å¤‰æ›´

ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã¯ `internal/storage/storage.go` ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼š

```go
const dataFilePath = "data/reservations.json"
```

å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã—ç›´ã—ã¦ãã ã•ã„ï¼š

```bash
# internal/storage/storage.go ã‚’ç·¨é›†
vi internal/storage/storage.go

# ãƒ“ãƒ«ãƒ‰
make build

# å®Ÿè¡Œ
make run
```

### ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å¤‰æ›´

`cmd/bot/main.go` ã® `initializeServices()` é–¢æ•°å†…ã‚’ç·¨é›†ï¼š

```go
func initializeServices() {
	store = storage.NewStorage()
	if err := store.Load(); err != nil {
		log.Fatalf("Failed to load reservations: %v", err)
	}
	log.Println("Reservations loaded successfully")

	// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ./logs
	logger = logging.NewLogger("./logs")

	// ä¾‹: /var/log/hxs ã«å¤‰æ›´
	// logger = logging.NewLogger("/var/log/hxs")

	log.Println("Logger initialized successfully")
}
```

## æ³¨æ„äº‹é …

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã«é–¢ã™ã‚‹æ³¨æ„

- âŒ `pending` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®äºˆç´„ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“
- âŒ å‰Šé™¤ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯å¾©å…ƒã§ãã¾ã›ã‚“
- âš ï¸ ä¿æŒæœŸé–“ã‚’çŸ­ãã—ã™ãã‚‹ã¨å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¾ã§å‰Šé™¤ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
- âœ… å‰Šé™¤å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™

### ãƒ­ã‚°ã«é–¢ã™ã‚‹æ³¨æ„

- ğŸ”’ æ©Ÿå¯†æƒ…å ±ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ï¼‰ã¯ãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã¾ã›ã‚“
- ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å†…å®¹ã¯ãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã¾ã›ã‚“ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é•·ã®ã¿è¨˜éŒ²ï¼‰
- ğŸ—‚ï¸ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯æœˆã”ã¨ã«åˆ†å‰²ã•ã‚Œã¾ã™
- ğŸ§¹ 1ã‹æœˆä»¥ä¸Šå‰ã®ãƒ­ã‚°ã¯è‡ªå‹•å‰Šé™¤ã•ã‚Œã¾ã™



## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### äºˆç´„ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œãªã„

**ç—‡çŠ¶**: Botå†èµ·å‹•å¾Œã«ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã‚‹

**åŸå› ã¨è§£æ±º**:
1. ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ã‚’ç¢ºèª
   ```bash
   ls -la data/reservations.json
   chmod 644 data/reservations.json
   ```

2. ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ç¢ºèª
   ```bash
   df -h
   ```

3. ãƒ­ã‚°ã‚’ç¢ºèª
   ```bash
   tail -f logs/commands_2025-11.log
   ```

---

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãŒå®Ÿè¡Œã•ã‚Œãªã„

**ç—‡çŠ¶**: å¤ã„ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œãªã„

**ç¢ºèªæ–¹æ³•**:
```bash
# ãƒ­ã‚°ã§å®Ÿè¡Œæ™‚åˆ»ã‚’ç¢ºèª
grep "Next cleanup scheduled" logs/commands_2025-11.log
grep "Cleaned up" logs/commands_2025-11.log
```

**è§£æ±ºæ–¹æ³•**:
- BotãŒåˆå‰3æ™‚ã«èµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- BotãŒé•·æ™‚é–“ç¨¼åƒã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆ24æ™‚é–“ä»¥ä¸Šï¼‰
- ãƒ­ã‚°ã«ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ç¢ºèª

---

### ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œãªã„

**ç—‡çŠ¶**: `logs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç©º

**è§£æ±ºæ–¹æ³•**:
1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
   ```bash
   mkdir -p logs
   chmod 755 logs
   ```

2. Botã‚’å†èµ·å‹•
   ```bash
   make run
   ```

3. ãƒ­ã‚°ãŒä½œæˆã•ã‚ŒãŸã‹ç¢ºèª
   ```bash
   ls -la logs/
   ```

## ã¾ã¨ã‚

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½ï¼š

âœ… **è‡ªå‹•ä¿å­˜** - ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•çš„ã«ä¿å­˜ã•ã‚Œã‚‹<br>
âœ… **è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—** - å¤ã„ãƒ‡ãƒ¼ã‚¿ã¯30æ—¥å¾Œã«è‡ªå‹•å‰Šé™¤<br>
âœ… **è‡ªå‹•ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³** - ãƒ­ã‚°ã¯æœˆã”ã¨ã«åˆ†å‰²<br>
âœ… **çµ±è¨ˆæ©Ÿèƒ½** - ã‚³ãƒãƒ³ãƒ‰ä½¿ç”¨çŠ¶æ³ã‚’è‡ªå‹•è¨˜éŒ²<br>
âœ… **å®Œå…¨è‡ªå‹•åŒ–** - æ‰‹å‹•ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸è¦

---
**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: [README](../README.md) | [èµ·å‹•ã‚¬ã‚¤ãƒ‰](SETUP.md) | [ã‚³ãƒãƒ³ãƒ‰](COMMANDS.md) | [systemd](SYSTEMD.md) | [é–‹ç™º](DEVELOPMENT.md)
